# SPDX-License-Identifier: (GPL-2.0-only OR BSD-2-Clause)
%YAML 1.2
---
$id: http://devicetree.org/schemas/interrupt-controller/riscv,aclint-swi.yaml#
$schema: http://devicetree.org/meta-schemas/core.yaml#

title: RISC-V ACLINT Software Interrupt Devices

maintainers:
  - Anup Patel <anup@brainfault.org>

description:
  RISC-V SOCs include an implementation of the M-level software interrupt
  (MSWI) device and the S-level software interrupt (SSWI) device defined
  in the RISC-V Advanced Core Local Interruptor (ACLINT) specification.

  The ACLINT MSWI and SSWI devices are documented in the RISC-V ACLINT
  specification located at
  https://github.com/riscv/riscv-aclint/blob/main/riscv-aclint.adoc.

  The ACLINT MSWI and SSWI devices directly connect to the M-level and
  S-level software interrupt lines of various HARTs (or CPUs) respectively
  so the RISC-V per-HART (or per-CPU) local interrupt controller is the
  parent interrupt controller for the ACLINT MSWI and SSWI devices.

allOf:
  - $ref: /schemas/interrupt-controller.yaml#

properties:
  compatible:
    oneOf:
      - items:
          - enum:
              - sifive,fu540-c000-aclint-mswi
          - const: riscv,aclint-mswi

      - items:
          - enum:
              - vendor,chip-aclint-sswi
          - const: riscv,aclint-sswi

    description:
      For ACLINT MSWI devices, it should be "<vendor>,<chip>-aclint-mswi"
      and "riscv,aclint-mswi".
      For ACLINT SSWI devices, it should be "<vendor>,<chip>-aclint-sswi"
      and "riscv,aclint-sswi".

  reg:
    maxItems: 1

  "#interrupt-cells":
    const: 0

  interrupts-extended:
    minItems: 1
    maxItems: 4095

  interrupt-controller: true

additionalProperties: false

required:
  - compatible
  - reg
  - interrupts-extended
  - interrupt-controller
  - "#interrupt-cells"

examples:
  - |
    // Example 1 (RISC-V MSWI device used by Linux RISC-V NoMMU kernel):

    interrupt-controller@2000000 {
      compatible = "sifive,fu540-c000-aclint-mswi", "riscv,aclint-mswi";
      interrupts-extended = <&cpu1intc 3>,
                            <&cpu2intc 3>,
                            <&cpu3intc 3>,
                            <&cpu4intc 3>;
      reg = <0x2000000 0x4000>;
      interrupt-controller;
      #interrupt-cells = <0>;
    };

  - |
    // Example 2 (RISC-V SSWI device used by Linux RISC-V MMU kernel):

    interrupt-controller@2f00000 {
      compatible = "vendor,chip-aclint-sswi", "riscv,aclint-sswi";
      interrupts-extended = <&cpu1intc 1>,
                            <&cpu2intc 1>,
                            <&cpu3intc 1>,
                            <&cpu4intc 1>;
      reg = <0x2f00000 0x4000>;
      interrupt-controller;
      #interrupt-cells = <0>;
    };
...
